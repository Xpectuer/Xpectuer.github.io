---
layout: post
title: "Go的编译过程"
tags: programming go compiler
categories: go
---
# 【学习笔记】Go的编译过程

##### 前导知识：编译原理、计算机组成原理

## 几个概念

### AST抽象语法树（Abstract Syntax Tree）

为了消除代码中无用的注释、空格等符号，编译器的主流方法是将代码的**语法元素**以树的形式存储起来

对于表达式``a*b+c``，可以表示为：

```
    +
   / \
  *   c
 /\
a  b
```

## 静态单赋值（Static Single Assignment，SSA）

中间表示（Intermediate Representation，IR）：编译器或虚拟机（这里特指java虚拟机一类的虚拟机），使用的内部代码或数据结构，它可以用来做一些**编译优化**后生成**更高效的目标代码**。

> A "good" IR must be *accurate* – capable of representing the source code without loss of information – and *independent* of any particular source or target language

静态单赋值是GO语言的中间代码的一种特性

对于任何具有这种特性的中间代码，每个变量只会被赋值一次。

以下实例将展示SSA生成的中间代码的效果:

```go
x := 1
x := 2
y := x
```

经过简单的分析，可以发现第一行代码是无用的。

因此，我们通过用**下标实现**SSA的方式来对这段程序进行优化：

```
x_1 = 1
x_2 = 2
y_1 = x_2
```

生成机器码时，编译器可以轻松的发现``x_1``与后面的代码执行没有任何关系，便可以在生成机器码时省略``x:=1``的赋值，通过减少需要执行的指令优化这段代码。



### 指令集

macos在命令行输入``uname -m`` 即可查看当前机器的架构信息。

对于指令集，大概可以分为两类：

- CISC复杂指令集：通过增加指令的类型减少需要执行的指令数。
- RISC精简指令集：通过使用更少的指令类型完成目标的计算任务。



## 编译原理
